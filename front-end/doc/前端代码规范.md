# 前端代码规范

## 一、技术栈规范

### 1.1 核心技术栈

| 类别 | 技术/框架 | 版本 | 说明 |
|------|----------|------|------|
| 框架 | Vue.js | 3.3+ | 前端核心框架 |
| 构建工具 | Vite | 4.4+ | 项目构建和开发服务器 |
| 包管理器 | npm | 9.0+ | 依赖管理 |
| 语言 | TypeScript | 5.0+ | 类型安全的JavaScript超集 |
| 状态管理 | Pinia | 2.1+ | 轻量级状态管理库 |
| HTTP客户端 | Axios | 1.5+ | API调用和拦截器 |
| UI框架 | Element Plus | 2.3+ | 组件库 |
| CSS预处理器 | SCSS | 1.6+ | 增强CSS功能 |

### 1.2 依赖管理策略

- 使用 `package.json` 管理项目依赖
- 明确指定依赖版本，避免使用 `^` 等模糊版本号
- 定期更新依赖，确保使用最新的安全补丁
- 使用 `npm audit` 检查依赖安全问题
- 分离开发依赖和生产依赖

## 二、代码风格指南

### 2.1 命名约定

#### 文件命名
- **组件文件**：使用 PascalCase，如 `UserManagement.vue`
- **工具文件**：使用 camelCase，如 `apiService.ts`
- **样式文件**：使用 kebab-case，如 `user-management.scss`
- **目录命名**：使用 kebab-case，如 `components`、`views`

#### 变量命名
- **普通变量**：使用 camelCase，如 `userName`
- **常量**：使用 UPPER_SNAKE_CASE，如 `MAX_PAGE_SIZE`
- **组件名称**：使用 PascalCase，如 `UserComponent`
- **Props**：使用 camelCase，如 `userId`
- **事件名称**：使用 kebab-case，如 `update:userInfo`

#### 函数命名
- **普通函数**：使用 camelCase，如 `getUserInfo()`
- **方法**：使用 camelCase，如 `validateForm()`
- **回调函数**：使用 camelCase，如 `onSuccess()`

### 2.2 文件组织结构

```
front-end/
├── public/                 # 静态资源
├── src/
│   ├── assets/             # 图片、图标等资源
│   ├── components/         # 通用组件
│   │   ├── base/           # 基础组件
│   │   └── business/       # 业务组件
│   ├── views/              # 页面组件
│   │   ├── user/           # 用户管理相关页面
│   │   ├── department/     # 部门管理相关页面
│   │   └── role/           # 角色管理相关页面
│   ├── router/             # 路由配置
│   ├── store/              # Pinia状态管理
│   ├── api/                # API请求
│   ├── utils/              # 工具函数
│   ├── styles/             # 全局样式
│   ├── types/              # TypeScript类型定义
│   ├── constants/          # 常量定义
│   ├── hooks/              # 自定义Hooks
│   ├── App.vue             # 根组件
│   └── main.ts             # 入口文件
├── index.html              # HTML模板
├── tsconfig.json           # TypeScript配置
├── vite.config.ts          # Vite配置
├── package.json            # 依赖管理
└── README.md               # 项目说明
```

### 2.3 导入/导出规范

- **导入顺序**：
  1. 第三方库
  2. 项目组件
  3. 工具函数
  4. 样式文件

- **导入方式**：
  - 使用具名导入，避免 `import * as`
  - 组件导入使用 PascalCase
  - 工具函数导入使用 camelCase

- **导出方式**：
  - 组件使用默认导出
  - 工具函数使用具名导出

### 2.4 代码格式化标准

- **缩进**：使用2个空格
- **分号**：不使用分号
- **引号**：使用单引号，JSX中使用双引号
- **大括号**：左大括号与语句同行
- **空行**：函数之间、逻辑块之间添加空行
- **行宽**：每行代码不超过100个字符
- **对象/数组**：单行对象/数组不超过80字符，超过则换行

### 2.5 ESLint配置

```json
{
  "root": true,
  "env": {
    "browser": true,
    "es2021": true,
    "node": true
  },
  "extends": [
    "eslint:recommended",
    "plugin:vue/vue3-recommended",
    "@vue/typescript/recommended",
    "@vue/prettier",
    "@vue/prettier/@typescript-eslint"
  ],
  "parserOptions": {
    "ecmaVersion": 2021,
    "parser": "@typescript-eslint/parser",
    "sourceType": "module"
  },
  "plugins": [
    "vue",
    "@typescript-eslint"
  ],
  "rules": {
    "vue/multi-word-component-names": "off",
    "@typescript-eslint/no-explicit-any": "off",
    "@typescript-eslint/explicit-module-boundary-types": "off"
  }
}
```

### 2.6 Prettier配置

```json
{
  "semi": false,
  "singleQuote": true,
  "tabWidth": 2,
  "trailingComma": "es5",
  "printWidth": 100,
  "arrowParens": "avoid"
}
```

## 三、组件开发规范

### 3.1 组件设计原则

- **单一职责**：每个组件只负责一项功能
- **可复用性**：设计通用组件，避免业务逻辑耦合
- **可维护性**：代码结构清晰，易于理解和修改
- **性能优化**：避免不必要的渲染和计算

### 3.2 组件结构

```vue
<template>
  <!-- 模板内容 -->
</template>

<script setup lang="ts">
// 组件逻辑
</script>

<style scoped lang="scss">
// 组件样式
</style>
```

### 3.3 Props管理

- 使用 TypeScript 类型定义 Props
- 为 Props 添加默认值
- 验证 Props 类型和必填项
- 示例：

```typescript
interface Props {
  userId: number
  userName?: string
  disabled: boolean
}

const props = defineProps<Props>({
  userId: {
    type: Number,
    required: true
  },
  userName: {
    type: String,
    default: ''
  },
  disabled: {
    type: Boolean,
    default: false
  }
})
```

### 3.4 事件处理

- 使用 `defineEmits` 定义组件事件
- 事件名称使用 kebab-case
- 示例：

```typescript
const emit = defineEmits<{
  (e: 'update:userInfo', userInfo: UserInfo): void
  (e: 'delete', userId: number): void
}>()

// 触发事件
emit('update:userInfo', newUserInfo)
```

### 3.5 生命周期

- 使用 Composition API 的生命周期钩子
- 合理使用 `onMounted`、`onUpdated`、`onUnmounted` 等钩子
- 避免在 `setup` 中直接操作 DOM

### 3.6 组件复用策略

- **基础组件**：封装通用 UI 元素，如按钮、输入框等
- **业务组件**：封装特定业务逻辑的组件
- **布局组件**：封装页面布局结构
- **使用插槽**：提高组件灵活性
- **使用 Provide/Inject**：在组件树中共享状态

## 四、样式规范

### 4.1 CSS方法论

- 使用 BEM (Block, Element, Modifier) 命名规范
- 示例：

```scss
// Block
.user-management {
  // Element
  &__header {
    // Modifier
    &--compact {
      padding: 8px;
    }
  }
  
  &__list {
    // Styles
  }
}
```

### 4.2 样式文件组织

- **全局样式**：`src/styles/index.scss`
- **组件样式**：使用 `<style scoped>` 或 CSS Modules
- **变量定义**：`src/styles/variables.scss`
- **混合器**：`src/styles/mixins.scss`
- **重置样式**：`src/styles/reset.scss`

### 4.3 响应式设计

- 使用媒体查询实现响应式布局
- 定义断点变量
- 示例：

```scss
$breakpoints: (
  'sm': 576px,
  'md': 768px,
  'lg': 992px,
  'xl': 1200px
);

@mixin respond-to($breakpoint) {
  @media (min-width: map-get($breakpoints, $breakpoint)) {
    @content;
  }
}

.container {
  width: 100%;
  
  @include respond-to('md') {
    width: 90%;
    margin: 0 auto;
  }
}
```

### 4.4 主题和设计系统

- 使用 CSS 变量定义主题色
- 统一管理字体、间距、圆角等设计变量
- 示例：

```scss
:root {
  // 主题色
  --primary-color: #409EFF;
  --success-color: #67C23A;
  --warning-color: #E6A23C;
  --danger-color: #F56C6C;
  
  // 字体
  --font-size-base: 14px;
  --font-size-lg: 16px;
  --font-size-sm: 12px;
  
  // 间距
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-md: 16px;
  --spacing-lg: 24px;
  --spacing-xl: 32px;
}
```

## 五、性能优化规范

### 5.1 代码分割

- 使用动态导入实现代码分割
- 按路由分割代码
- 示例：

```typescript
const UserManagement = () => import('@/views/user/UserManagement.vue')

const routes = [
  {
    path: '/user',
    component: UserManagement
  }
]
```

### 5.2 懒加载

- **图片懒加载**：使用 `v-lazy` 指令
- **组件懒加载**：使用动态导入
- **路由懒加载**：按路由分割代码

### 5.3 虚拟滚动

- 对于长列表，使用虚拟滚动技术
- 推荐使用 `vue-virtual-scroller` 等库

### 5.4 缓存策略

- 使用 `keep-alive` 缓存组件状态
- 缓存 API 响应数据
- 合理设置缓存过期时间

### 5.5 内存管理

- 及时清理定时器和事件监听器
- 避免循环引用
- 合理使用 `onUnmounted` 钩子清理资源

## 六、工程化规范

### 6.1 项目配置

#### Vite配置

```typescript
// vite.config.ts
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import path from 'path'

export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src')
    }
  },
  server: {
    port: 3000,
    open: true,
    proxy: {
      '/api': {
        target: 'http://localhost:8080',
        changeOrigin: true
      }
    }
  },
  build: {
    outDir: 'dist',
    sourcemap: false,
    minify: 'terser'
  }
})
```

#### TypeScript配置

```json
// tsconfig.json
{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "module": "ESNext",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "skipLibCheck": true,
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "preserve",
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true,
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["src/**/*.ts", "src/**/*.d.ts", "src/**/*.tsx", "src/**/*.vue"],
  "references": [{ "path": "./tsconfig.node.json" }]
}
```

### 6.2 环境变量管理

- 使用 `.env` 文件管理环境变量
- 分离开发、测试、生产环境配置
- 示例：

```
// .env.development
VITE_API_BASE_URL=http://localhost:8080/api
VITE_APP_TITLE=开发环境

// .env.production
VITE_API_BASE_URL=https://api.example.com
VITE_APP_TITLE=生产环境
```

- 在代码中使用：

```typescript
const apiBaseUrl = import.meta.env.VITE_API_BASE_URL
```

### 6.3 构建和部署

- **构建命令**：`npm run build`
- **预览命令**：`npm run preview`
- **部署流程**：
  1. 代码提交到 Git 仓库
  2. CI/CD 流程自动构建
  3. 部署到服务器

### 6.4 代码审查

- 使用 Git 提交规范
- 示例：`feat(user): 添加用户管理功能`
- 使用 Pull Request 进行代码审查
- 集成 ESLint 和 Prettier 到 CI 流程

## 七、最佳实践

### 7.1 代码组织

- **组件拆分**：将复杂组件拆分为多个子组件
- **逻辑分离**：将业务逻辑从组件中分离到工具函数或服务中
- **状态管理**：合理使用 Pinia 管理全局状态

### 7.2 API 调用

- 封装 API 调用到单独的服务文件
- 使用 Axios 拦截器处理请求和响应
- 统一错误处理

### 7.3 表单处理

- 使用 `v-model` 双向绑定
- 使用 Element Plus 的表单验证
- 封装表单逻辑到 composable

### 7.4 测试

- 使用 Vitest 进行单元测试
- 使用 Cypress 进行端到端测试
- 测试覆盖核心业务逻辑

### 7.5 文档

- 为组件添加 JSDoc 注释
- 编写 README.md 说明组件用法
- 使用 Storybook 展示组件库

## 八、附则

- 本规范适用于所有前端代码开发
- 开发人员应严格遵守本规范
- 规范将根据项目实际情况和技术发展进行更新
- 如有疑问，应及时与团队讨论确定

---

**最后更新时间**：2026-02-16
**版本**：1.0.0